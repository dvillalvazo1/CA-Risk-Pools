
Data gathered on 1/3/2026 from https://www.remif.com/208/Financial-Audit-Reports 

```{r}
# load libraries
library(readr)
library(tidyverse)

# load data
remif <- read_csv("~/Desktop/Desktop - Deboraâ€™s MacBook Pro/CA_risk_pools/remif.csv")
 
remif <- remif %>%
  mutate(
    city = str_squish(city),
    fy_joined = str_squish(year_joined),
    last_fy_reported = str_squish(fy_end)
  )

# helper to extract FY start year
parse_fy_start <- function(x) {
  x_num <- str_extract(x, "^\\d{4}") %>% as.numeric()
  # if missing, return a very early year so that all later FYs are counted
  ifelse(is.na(x_num), 1900, x_num)
}

remif <- remif %>%
  mutate(
    join_start = parse_fy_start(fy_joined),
    last_start = parse_fy_start(last_fy_reported)
  )

fy_seq <- 2010:2020

# build long panel
remif_long <- remif %>%
  select(city, fy_joined, last_fy_reported, join_start, last_start) %>%
  crossing(fy_start = fy_seq) %>%
  mutate(
    member = if_else(
      fy_start >= join_start & (is.na(last_start) | fy_start <= last_start),
      1L,
      0L
    ),
    fy = paste0(fy_start, "-", fy_start + 1)
  )

# widen keeping fy_joined + last_fy_reported
remif_wide <- remif_long %>%
  select(city, fy_joined, last_fy_reported, fy, member) %>%
  pivot_wider(
    names_from  = fy,
    values_from = member,
    values_fill = 0
  )

# export data as a csv. 
write.csv(remif_wide, file = "remifdata.csv")

```
